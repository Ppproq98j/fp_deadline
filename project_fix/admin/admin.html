<!doctype html>
<html lang="id" class="h-full">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Deadline Manager</title>
  <script src="/_sdk/data_sdk.js"></script>
  <script src="/_sdk/element_sdk.js"></script>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    body {
      box-sizing: border-box;
    }

    * {
      box-sizing: border-box;
    }

    .fade-in {
      animation: fadeIn 0.3s ease-in;
    }

    @keyframes fadeIn {
      from {
        opacity: 0;
        transform: translateY(-10px);
      }

      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    .slide-in {
      animation: slideIn 0.3s ease-out;
    }

    @keyframes slideIn {
      from {
        transform: translateX(-20px);
        opacity: 0;
      }

      to {
        transform: translateX(0);
        opacity: 1;
      }
    }

    .priority-high {
      border-left: 4px solid #ef4444;
    }

    .priority-medium {
      border-left: 4px solid #f59e0b;
    }

    .priority-low {
      border-left: 4px solid #10b981;
    }

    .calendar-grid {
      display: grid;
      grid-template-columns: repeat(7, 1fr);
      gap: 8px;
    }

    .calendar-day {
      aspect-ratio: 1;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      border-radius: 8px;
      cursor: pointer;
      transition: all 0.2s;
    }

    .calendar-day:hover {
      transform: scale(1.05);
    }

    .has-deadline {
      position: relative;
    }

    .has-deadline::after {
      content: '';
      position: absolute;
      bottom: 4px;
      width: 6px;
      height: 6px;
      background: currentColor;
      border-radius: 50%;
    }

    .sidebar {
      position: fixed;
      left: -280px;
      top: 0;
      width: 280px;
      height: 100%;
      z-index: 1001;
      transition: left 0.3s ease;
      box-shadow: 2px 0 8px rgba(0, 0, 0, 0.1);
    }

    .sidebar.open {
      left: 0;
    }

    .sidebar-overlay {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.5);
      z-index: 1000;
      opacity: 0;
      visibility: hidden;
      transition: opacity 0.3s ease, visibility 0.3s ease;
    }

    .sidebar-overlay.show {
      opacity: 1;
      visibility: visible;
    }

    .hamburger {
      width: 24px;
      height: 20px;
      position: relative;
      cursor: pointer;
      display: inline-block;
    }

    .hamburger span {
      display: block;
      position: absolute;
      height: 3px;
      width: 100%;
      background: currentColor;
      border-radius: 3px;
      opacity: 1;
      left: 0;
      transition: 0.25s ease-in-out;
    }

    .hamburger span:nth-child(1) {
      top: 0;
    }

    .hamburger span:nth-child(2) {
      top: 8px;
    }

    .hamburger span:nth-child(3) {
      top: 16px;
    }

    .toast {
      position: fixed;
      bottom: 20px;
      right: 20px;
      padding: 16px 24px;
      border-radius: 8px;
      color: white;
      font-weight: 500;
      z-index: 1000;
      animation: slideUp 0.3s ease-out;
    }

    @keyframes slideUp {
      from {
        transform: translateY(100px);
        opacity: 0;
      }

      to {
        transform: translateY(0);
        opacity: 1;
      }
    }

    .modal-overlay {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.5);
      display: flex;
      align-items: center;
      justify-content: center;
      z-index: 999;
      animation: fadeIn 0.2s ease-in;
    }

    .modal-content {
      background: white;
      border-radius: 12px;
      padding: 24px;
      max-width: 500px;
      width: 90%;
      max-height: 90%;
      overflow-y: auto;
      animation: slideIn 0.3s ease-out;
    }

    .loading-spinner {
      border: 3px solid rgba(255, 255, 255, 0.3);
      border-top-color: white;
      border-radius: 50%;
      width: 20px;
      height: 20px;
      animation: spin 0.8s linear infinite;
    }

    @keyframes spin {
      to {
        transform: rotate(360deg);
      }
    }
  </style>
  <style>
    @view-transition {
      navigation: auto;
    }
  </style>
</head>

<body class="w-full h-full m-0 p-0">
  <div id="app" class="w-full h-full"></div>
  <script>
    // Configuration
    const defaultConfig = {
      app_title: "Deadline Manager",
      welcome_message: "Kelola deadline Anda dengan efisien",
      button_text: "Tambah Deadline Baru",
      background_color: "#f0f4f8",
      surface_color: "#ffffff",
      text_color: "#1e293b",
      primary_action_color: "#3b82f6",
      secondary_action_color: "#64748b",
      font_family: "Inter",
      font_size: 16
    };

    // Data storage
    let deadlines = [];
    let currentUser = null;
    let currentView = 'login';
    let filterStatus = 'all';
    let filterPriority = 'all';
    let searchQuery = '';
    let selectedDate = new Date();
    let isAdmin = false;
    let adminView = 'users';

    // Shared data - synchronized between admin and users
    let users = JSON.parse(localStorage.getItem('app_users') || '[]');
    let notificationLogs = JSON.parse(localStorage.getItem('app_notifications') || '[]');
    let broadcastMessages = JSON.parse(localStorage.getItem('app_broadcasts') || '[]');

    // Initialize default users if empty
    if (users.length === 0) {
      users = [
        { id: '1', name: 'Demo User', email: 'user@demo.com', password: 'user123', registered: new Date().toISOString().split('T')[0], status: 'active' }
      ];
      localStorage.setItem('app_users', JSON.stringify(users));
    }

    // Function to save data to localStorage
    function saveUsers() {
      localStorage.setItem('app_users', JSON.stringify(users));
    }

    function saveNotifications() {
      localStorage.setItem('app_notifications', JSON.stringify(notificationLogs));
    }

    function saveBroadcasts() {
      localStorage.setItem('app_broadcasts', JSON.stringify(broadcastMessages));
    }

    // Function to calculate user statistics from their deadlines
    function getUserStats(userId) {
      const userDeadlines = deadlines.filter(d => d.userId === userId);
      return {
        activeDeadlines: userDeadlines.filter(d => !d.completed).length,
        completedDeadlines: userDeadlines.filter(d => d.completed).length
      };
    }

    // Data handler
    const dataHandler = {
      onDataChanged(data) {
        // Store all deadlines from database
        deadlines = data;
        if (currentView === 'dashboard' || currentView === 'calendar' || currentView === 'statistics') {
          renderApp();
        }
      }
    };

    // Get deadlines for current user only
    function getCurrentUserDeadlines() {
      if (!currentUser) return [];
      return deadlines.filter(d => d.userId === currentUser.id);
    }

    // Initialize SDK
    async function initializeApp() {
      const result = await window.dataSdk.init(dataHandler);
      if (!result.isOk) {
        showToast('Gagal menginisialisasi aplikasi', 'error');
        return;
      }
      renderApp();
    }

    // Render functions
    function renderApp() {
      const app = document.getElementById('app');

      if (currentView === 'login') {
        app.innerHTML = renderLoginPage();
      } else if (currentView === 'admin-login') {
        app.innerHTML = renderAdminLoginPage();
      } else if (currentView === 'admin') {
        app.innerHTML = renderAdminDashboard();
      } else if (currentView === 'register') {
        app.innerHTML = renderRegisterPage();
      } else if (currentView === 'dashboard') {
        app.innerHTML = renderDashboard();
      } else if (currentView === 'calendar') {
        app.innerHTML = renderCalendar();
      } else if (currentView === 'profile') {
        app.innerHTML = renderProfile();
      } else if (currentView === 'notifications') {
        app.innerHTML = renderNotifications();
      } else if (currentView === 'statistics') {
        app.innerHTML = renderStatistics();
      }

      attachEventListeners();
    }

    function renderLoginPage() {
      const config = window.elementSdk?.config || defaultConfig;
      const customFont = config.font_family || defaultConfig.font_family;
      const baseFontStack = 'system-ui, -apple-system, sans-serif';
      const baseSize = config.font_size || defaultConfig.font_size;

      return `
        <div class="w-full h-full flex items-center justify-center p-6" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); font-family: ${customFont}, ${baseFontStack};">
          <div class="w-full max-w-md fade-in" style="background: ${config.surface_color || defaultConfig.surface_color}; border-radius: 20px; padding: 40px; box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);">
            <div class="text-center mb-8">
              <div style="width: 80px; height: 80px; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); border-radius: 20px; display: flex; align-items: center; justify-content: center; margin: 0 auto 20px; font-size: 40px; box-shadow: 0 8px 16px rgba(102, 126, 234, 0.4);">
                üìã
              </div>
              <h1 style="font-size: ${baseSize * 2.2}px; font-weight: 700; color: ${config.text_color || defaultConfig.text_color}; margin-bottom: 8px;">${config.app_title || defaultConfig.app_title}</h1>
              <p style="font-size: ${baseSize}px; color: ${config.secondary_action_color || defaultConfig.secondary_action_color};">${config.welcome_message || defaultConfig.welcome_message}</p>
            </div>

            <div style="padding: 16px; background: linear-gradient(135deg, #dbeafe 0%, #e0e7ff 100%); border-radius: 12px; margin-bottom: 24px; border: 2px solid ${config.primary_action_color || defaultConfig.primary_action_color};">
              <p style="font-size: ${baseSize * 0.85}px; color: #1e40af; margin: 0; text-align: center; line-height: 1.6;">
                <strong style="display: block; font-size: ${baseSize * 0.9}px; margin-bottom: 4px;">üéØ Demo Account</strong>
                <span style="display: block;">üìß <strong>Email:</strong> user@demo.com</span>
                <span style="display: block;">üîë <strong>Password:</strong> user123</span>
              </p>
            </div>

            <form id="login-form" style="display: flex; flex-direction: column; gap: 20px;">
              <div>
                <label for="login-email" style="display: block; font-size: ${baseSize * 0.9}px; font-weight: 600; color: ${config.text_color || defaultConfig.text_color}; margin-bottom: 8px;">üìß Email Address</label>
                <input type="email" id="login-email" required style="width: 100%; padding: 14px 16px; border: 2px solid #e2e8f0; border-radius: 10px; font-size: ${baseSize}px; color: ${config.text_color || defaultConfig.text_color}; outline: none; transition: all 0.3s;" placeholder="your.email@example.com" onfocus="this.style.borderColor='${config.primary_action_color || defaultConfig.primary_action_color}'; this.style.boxShadow='0 0 0 3px ${config.primary_action_color || defaultConfig.primary_action_color}20';" onblur="this.style.borderColor='#e2e8f0'; this.style.boxShadow='none';">
              </div>

              <div>
                <label for="login-password" style="display: block; font-size: ${baseSize * 0.9}px; font-weight: 600; color: ${config.text_color || defaultConfig.text_color}; margin-bottom: 8px;">üîí Password</label>
                <input type="password" id="login-password" required style="width: 100%; padding: 14px 16px; border: 2px solid #e2e8f0; border-radius: 10px; font-size: ${baseSize}px; color: ${config.text_color || defaultConfig.text_color}; outline: none; transition: all 0.3s;" placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢" onfocus="this.style.borderColor='${config.primary_action_color || defaultConfig.primary_action_color}'; this.style.boxShadow='0 0 0 3px ${config.primary_action_color || defaultConfig.primary_action_color}20';" onblur="this.style.borderColor='#e2e8f0'; this.style.boxShadow='none';">
              </div>

              <button type="submit" id="login-btn" style="width: 100%; padding: 16px; background: linear-gradient(135deg, ${config.primary_action_color || defaultConfig.primary_action_color} 0%, #5b21b6 100%); color: white; border: none; border-radius: 10px; font-size: ${baseSize * 1.1}px; font-weight: 700; cursor: pointer; transition: all 0.3s; box-shadow: 0 4px 12px ${config.primary_action_color || defaultConfig.primary_action_color}40; margin-top: 8px;" onmouseover="this.style.transform='translateY(-2px)'; this.style.boxShadow='0 6px 20px ${config.primary_action_color || defaultConfig.primary_action_color}60';" onmouseout="this.style.transform='translateY(0)'; this.style.boxShadow='0 4px 12px ${config.primary_action_color || defaultConfig.primary_action_color}40';">
                üöÄ Sign In
              </button>
            </form>

            <div style="margin-top: 24px; padding-top: 24px; border-top: 2px solid #e2e8f0;">
              <p style="font-size: ${baseSize * 0.9}px; color: ${config.secondary_action_color || defaultConfig.secondary_action_color}; text-align: center; margin-bottom: 12px;">
                Don't have an account? 
                <button id="goto-register" style="color: ${config.primary_action_color || defaultConfig.primary_action_color}; font-weight: 700; background: none; border: none; cursor: pointer; text-decoration: none; font-size: ${baseSize * 0.9}px;" onmouseover="this.style.textDecoration='underline';" onmouseout="this.style.textDecoration='none';">Create Account ‚Üí</button>
              </p>
              <p style="font-size: ${baseSize * 0.85}px; color: ${config.secondary_action_color || defaultConfig.secondary_action_color}; text-align: center;">
                <button id="goto-admin-login" style="color: ${config.secondary_action_color || defaultConfig.secondary_action_color}; font-weight: 500; background: none; border: none; cursor: pointer; text-decoration: none; font-size: ${baseSize * 0.85}px;" onmouseover="this.style.textDecoration='underline'; this.style.color='${config.primary_action_color || defaultConfig.primary_action_color}';" onmouseout="this.style.textDecoration='none'; this.style.color='${config.secondary_action_color || defaultConfig.secondary_action_color}';">üõ°Ô∏è Admin Login</button>
              </p>
            </div>
          </div>
        </div>
      `;
    }

    function renderAdminLoginPage() {
      const config = window.elementSdk?.config || defaultConfig;
      const customFont = config.font_family || defaultConfig.font_family;
      const baseFontStack = 'system-ui, -apple-system, sans-serif';
      const baseSize = config.font_size || defaultConfig.font_size;

      return `
        <div class="w-full h-full flex items-center justify-center p-6" style="background: ${config.background_color || defaultConfig.background_color}; font-family: ${customFont}, ${baseFontStack};">
          <div class="w-full max-w-md fade-in" style="background: ${config.surface_color || defaultConfig.surface_color}; border-radius: 16px; padding: 32px; box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);">
            <div class="text-center mb-8">
              <div style="width: 60px; height: 60px; background: ${config.primary_action_color || defaultConfig.primary_action_color}; border-radius: 12px; display: flex; align-items: center; justify-content: center; margin: 0 auto 16px; font-size: 28px;">
                üë§
              </div>
              <h1 style="font-size: ${baseSize * 2}px; font-weight: 700; color: ${config.text_color || defaultConfig.text_color}; margin-bottom: 8px;">Login Admin</h1>
              <p style="font-size: ${baseSize * 0.9}px; color: ${config.secondary_action_color || defaultConfig.secondary_action_color};">Akses panel administrator</p>
            </div>

            <form id="admin-login-form" class="space-y-4">
              <div>
                <label for="admin-email" style="display: block; font-size: ${baseSize * 0.9}px; font-weight: 500; color: ${config.text_color || defaultConfig.text_color}; margin-bottom: 8px;">Email Admin</label>
                <input type="email" id="admin-email" required style="width: 100%; padding: 12px; border: 2px solid #e2e8f0; border-radius: 8px; font-size: ${baseSize}px; color: ${config.text_color || defaultConfig.text_color}; outline: none;" placeholder="admin@example.com">
              </div>

              <div>
                <label for="admin-password" style="display: block; font-size: ${baseSize * 0.9}px; font-weight: 500; color: ${config.text_color || defaultConfig.text_color}; margin-bottom: 8px;">Password</label>
                <input type="password" id="admin-password" required style="width: 100%; padding: 12px; border: 2px solid #e2e8f0; border-radius: 8px; font-size: ${baseSize}px; color: ${config.text_color || defaultConfig.text_color}; outline: none;" placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢">
              </div>

              <div style="padding: 12px; background: #fef3c7; border-left: 4px solid #f59e0b; border-radius: 8px;">
                <p style="font-size: ${baseSize * 0.8}px; color: #92400e; margin: 0;">
                  <strong>Demo:</strong> email: admin@demo.com | password: admin123
                </p>
              </div>

              <button type="submit" id="admin-login-btn" style="width: 100%; padding: 14px; background: ${config.primary_action_color || defaultConfig.primary_action_color}; color: white; border: none; border-radius: 8px; font-size: ${baseSize}px; font-weight: 600; cursor: pointer; transition: all 0.2s;">
                Masuk sebagai Admin
              </button>
            </form>

            <div class="text-center mt-6">
              <button id="back-to-user-login" style="color: ${config.secondary_action_color || defaultConfig.secondary_action_color}; font-weight: 500; background: none; border: none; cursor: pointer; text-decoration: underline; font-size: ${baseSize * 0.9}px;">
                ‚Üê Kembali ke Login User
              </button>
            </div>
          </div>
        </div>
      `;
    }

    function renderRegisterPage() {
      const config = window.elementSdk?.config || defaultConfig;
      const customFont = config.font_family || defaultConfig.font_family;
      const baseFontStack = 'system-ui, -apple-system, sans-serif';
      const baseSize = config.font_size || defaultConfig.font_size;

      return `
        <div class="w-full h-full flex items-center justify-center p-6" style="background: ${config.background_color || defaultConfig.background_color}; font-family: ${customFont}, ${baseFontStack};">
          <div class="w-full max-w-md fade-in" style="background: ${config.surface_color || defaultConfig.surface_color}; border-radius: 16px; padding: 32px; box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);">
            <div class="text-center mb-8">
              <h1 style="font-size: ${baseSize * 2}px; font-weight: 700; color: ${config.text_color || defaultConfig.text_color}; margin-bottom: 8px;">Daftar Akun</h1>
              <p style="font-size: ${baseSize * 0.9}px; color: ${config.secondary_action_color || defaultConfig.secondary_action_color};">Buat akun baru untuk memulai</p>
            </div>

            <form id="register-form" class="space-y-4">
              <div>
                <label for="register-name" style="display: block; font-size: ${baseSize * 0.9}px; font-weight: 500; color: ${config.text_color || defaultConfig.text_color}; margin-bottom: 8px;">Nama Lengkap</label>
                <input type="text" id="register-name" required style="width: 100%; padding: 12px; border: 2px solid #e2e8f0; border-radius: 8px; font-size: ${baseSize}px; color: ${config.text_color || defaultConfig.text_color}; outline: none;" placeholder="John Doe">
              </div>

              <div>
                <label for="register-email" style="display: block; font-size: ${baseSize * 0.9}px; font-weight: 500; color: ${config.text_color || defaultConfig.text_color}; margin-bottom: 8px;">Email</label>
                <input type="email" id="register-email" required style="width: 100%; padding: 12px; border: 2px solid #e2e8f0; border-radius: 8px; font-size: ${baseSize}px; color: ${config.text_color || defaultConfig.text_color}; outline: none;" placeholder="email@example.com">
              </div>

              <div>
                <label for="register-password" style="display: block; font-size: ${baseSize * 0.9}px; font-weight: 500; color: ${config.text_color || defaultConfig.text_color}; margin-bottom: 8px;">Password</label>
                <input type="password" id="register-password" required style="width: 100%; padding: 12px; border: 2px solid #e2e8f0; border-radius: 8px; font-size: ${baseSize}px; color: ${config.text_color || defaultConfig.text_color}; outline: none;" placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢">
              </div>

              <button type="submit" id="register-btn" style="width: 100%; padding: 14px; background: ${config.primary_action_color || defaultConfig.primary_action_color}; color: white; border: none; border-radius: 8px; font-size: ${baseSize}px; font-weight: 600; cursor: pointer; transition: all 0.2s;">
                Daftar
              </button>
            </form>

            <div class="text-center mt-6">
              <p style="font-size: ${baseSize * 0.9}px; color: ${config.secondary_action_color || defaultConfig.secondary_action_color};">
                Sudah punya akun? 
                <button id="goto-login" style="color: ${config.primary_action_color || defaultConfig.primary_action_color}; font-weight: 600; background: none; border: none; cursor: pointer; text-decoration: underline;">Masuk di sini</button>
              </p>
            </div>
          </div>
        </div>
      `;
    }

    function renderAdminDashboard() {
      const config = window.elementSdk?.config || defaultConfig;
      const customFont = config.font_family || defaultConfig.font_family;
      const baseFontStack = 'system-ui, -apple-system, sans-serif';
      const baseSize = config.font_size || defaultConfig.font_size;

      let content = '';
      if (adminView === 'users') {
        content = renderAdminUsers();
      } else if (adminView === 'broadcast') {
        content = renderAdminBroadcast();
      } else if (adminView === 'reports') {
        content = renderAdminReports();
      } else if (adminView === 'monitoring') {
        content = renderAdminMonitoring();
      }

      return `
        <div class="w-full h-full" style="background: ${config.background_color || defaultConfig.background_color}; font-family: ${customFont}, ${baseFontStack};">
          ${renderAdminSidebar()}
          ${renderAdminNavbar()}

          <div style="max-width: 1400px; margin: 0 auto; padding: 24px;">
            ${content}
          </div>
        </div>
      `;
    }

    function renderAdminNavbar() {
      const config = window.elementSdk?.config || defaultConfig;
      const baseSize = config.font_size || defaultConfig.font_size;

      return `
        <nav style="background: ${config.surface_color || defaultConfig.surface_color}; box-shadow: 0 2px 4px rgba(0, 0, 0, 0.05); padding: 16px 24px;">
          <div style="max-width: 1400px; margin: 0 auto; display: flex; justify-content: space-between; align-items: center; gap: 16px;">
            <div style="display: flex; align-items: center; gap: 16px;">
              <button id="admin-menu-toggle" class="hamburger" style="background: none; border: none; color: ${config.text_color || defaultConfig.text_color}; padding: 0;">
                <span></span>
                <span></span>
                <span></span>
              </button>
              <div>
                <h1 style="font-size: ${baseSize * 1.5}px; font-weight: 700; color: ${config.text_color || defaultConfig.text_color}; margin: 0;">üõ°Ô∏è Admin Panel</h1>
                <p style="font-size: ${baseSize * 0.8}px; color: ${config.secondary_action_color || defaultConfig.secondary_action_color}; margin: 4px 0 0 0;">Dashboard Administrator</p>
              </div>
            </div>
          </div>
        </nav>
      `;
    }

    function renderAdminSidebar() {
      const config = window.elementSdk?.config || defaultConfig;
      const baseSize = config.font_size || defaultConfig.font_size;

      return `
        <div id="admin-sidebar-overlay" class="sidebar-overlay"></div>
        <div id="admin-sidebar" class="sidebar" style="background: ${config.surface_color || defaultConfig.surface_color};">
          <div style="padding: 24px;">
            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 32px;">
              <h3 style="font-size: ${baseSize * 1.3}px; font-weight: 700; color: ${config.text_color || defaultConfig.text_color}; margin: 0;">Admin Menu</h3>
              <button id="close-admin-sidebar" style="background: none; border: none; font-size: ${baseSize * 1.5}px; color: ${config.secondary_action_color || defaultConfig.secondary_action_color}; cursor: pointer; padding: 0; width: 32px; height: 32px; display: flex; align-items: center; justify-content: center;">√ó</button>
            </div>

            <div style="display: flex; flex-direction: column; gap: 8px;">
              <button id="admin-sidebar-users" class="sidebar-nav-btn" style="width: 100%; padding: 14px 16px; background: ${adminView === 'users' ? config.primary_action_color || defaultConfig.primary_action_color : 'transparent'}; color: ${adminView === 'users' ? 'white' : config.text_color || defaultConfig.text_color}; border: none; border-radius: 8px; font-size: ${baseSize}px; font-weight: 600; cursor: pointer; text-align: left; display: flex; align-items: center; gap: 12px; transition: all 0.2s;">
                <span style="font-size: ${baseSize * 1.2}px;">üë•</span>
                Kelola User
              </button>

              <button id="admin-sidebar-broadcast" class="sidebar-nav-btn" style="width: 100%; padding: 14px 16px; background: ${adminView === 'broadcast' ? config.primary_action_color || defaultConfig.primary_action_color : 'transparent'}; color: ${adminView === 'broadcast' ? 'white' : config.text_color || defaultConfig.text_color}; border: none; border-radius: 8px; font-size: ${baseSize}px; font-weight: 600; cursor: pointer; text-align: left; display: flex; align-items: center; gap: 12px; transition: all 0.2s;">
                <span style="font-size: ${baseSize * 1.2}px;">üì¢</span>
                Broadcast Notifikasi
              </button>

              <button id="admin-sidebar-reports" class="sidebar-nav-btn" style="width: 100%; padding: 14px 16px; background: ${adminView === 'reports' ? config.primary_action_color || defaultConfig.primary_action_color : 'transparent'}; color: ${adminView === 'reports' ? 'white' : config.text_color || defaultConfig.text_color}; border: none; border-radius: 8px; font-size: ${baseSize}px; font-weight: 600; cursor: pointer; text-align: left; display: flex; align-items: center; gap: 12px; transition: all 0.2s;">
                <span style="font-size: ${baseSize * 1.2}px;">üìä</span>
                Laporan Penggunaan
              </button>

              <button id="admin-sidebar-monitoring" class="sidebar-nav-btn" style="width: 100%; padding: 14px 16px; background: ${adminView === 'monitoring' ? config.primary_action_color || defaultConfig.primary_action_color : 'transparent'}; color: ${adminView === 'monitoring' ? 'white' : config.text_color || defaultConfig.text_color}; border: none; border-radius: 8px; font-size: ${baseSize}px; font-weight: 600; cursor: pointer; text-align: left; display: flex; align-items: center; gap: 12px; transition: all 0.2s;">
                <span style="font-size: ${baseSize * 1.2}px;">üì°</span>
                Monitoring Notifikasi
              </button>
            </div>

            <hr style="border: none; border-top: 1px solid #e2e8f0; margin: 16px 0;">

            <button id="admin-sidebar-logout" style="width: 100%; padding: 14px 16px; background: transparent; color: #ef4444; border: none; border-radius: 8px; font-size: ${baseSize}px; font-weight: 600; cursor: pointer; text-align: left; display: flex; align-items: center; gap: 12px; transition: all 0.2s; margin-bottom: 16px;">
              <span style="font-size: ${baseSize * 1.2}px;">üö™</span>
              Keluar
            </button>

            <div style="padding: 16px; background: ${config.background_color || defaultConfig.background_color}; border-radius: 8px;">
              <p style="font-size: ${baseSize * 0.85}px; color: ${config.secondary_action_color || defaultConfig.secondary_action_color}; margin: 0;">
                <strong>Administrator</strong><br>
                ${currentUser?.email || 'admin@demo.com'}
              </p>
            </div>
          </div>
        </div>
      `;
    }

    function renderAdminUsers() {
      const config = window.elementSdk?.config || defaultConfig;
      const baseSize = config.font_size || defaultConfig.font_size;

      return `
        <div class="fade-in">
          <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 24px; flex-wrap: wrap; gap: 12px;">
            <h2 style="font-size: ${baseSize * 1.5}px; font-weight: 700; color: ${config.text_color || defaultConfig.text_color}; margin: 0;">Kelola Data User</h2>
            <div style="display: flex; gap: 12px;">
              <input type="text" id="admin-search-user" placeholder="Cari user..." style="padding: 10px 16px; border: 2px solid #e2e8f0; border-radius: 8px; font-size: ${baseSize * 0.9}px; outline: none;">
              <button id="admin-add-user" style="padding: 10px 20px; background: ${config.primary_action_color || defaultConfig.primary_action_color}; color: white; border: none; border-radius: 8px; font-size: ${baseSize * 0.9}px; cursor: pointer; white-space: nowrap;">
                + Tambah User
              </button>
            </div>
          </div>

          <div style="background: ${config.surface_color || defaultConfig.surface_color}; border-radius: 12px; overflow: hidden; box-shadow: 0 2px 4px rgba(0, 0, 0, 0.05);">
            <div style="overflow-x: auto;">
              <table style="width: 100%; border-collapse: collapse;">
                <thead style="background: ${config.background_color || defaultConfig.background_color};">
                  <tr>
                    <th style="padding: 16px; text-align: left; font-size: ${baseSize * 0.9}px; font-weight: 600; color: ${config.text_color || defaultConfig.text_color};">Nama</th>
                    <th style="padding: 16px; text-align: left; font-size: ${baseSize * 0.9}px; font-weight: 600; color: ${config.text_color || defaultConfig.text_color};">Email</th>
                    <th style="padding: 16px; text-align: left; font-size: ${baseSize * 0.9}px; font-weight: 600; color: ${config.text_color || defaultConfig.text_color};">Tanggal Daftar</th>
                    <th style="padding: 16px; text-align: center; font-size: ${baseSize * 0.9}px; font-weight: 600; color: ${config.text_color || defaultConfig.text_color};">Deadline Aktif</th>
                    <th style="padding: 16px; text-align: center; font-size: ${baseSize * 0.9}px; font-weight: 600; color: ${config.text_color || defaultConfig.text_color};">Selesai</th>
                    <th style="padding: 16px; text-align: center; font-size: ${baseSize * 0.9}px; font-weight: 600; color: ${config.text_color || defaultConfig.text_color};">Status</th>
                    <th style="padding: 16px; text-align: center; font-size: ${baseSize * 0.9}px; font-weight: 600; color: ${config.text_color || defaultConfig.text_color};">Aksi</th>
                  </tr>
                </thead>
                <tbody>
                  ${users.map((user, index) => {
        const stats = getUserStats(user.id);
        return `
                    <tr style="border-top: 1px solid #e2e8f0;">
                      <td style="padding: 16px; font-size: ${baseSize * 0.9}px; color: ${config.text_color || defaultConfig.text_color};">${user.name}</td>
                      <td style="padding: 16px; font-size: ${baseSize * 0.9}px; color: ${config.text_color || defaultConfig.text_color};">${user.email}</td>
                      <td style="padding: 16px; font-size: ${baseSize * 0.85}px; color: ${config.secondary_action_color || defaultConfig.secondary_action_color};">${formatDate(user.registered)}</td>
                      <td style="padding: 16px; text-align: center;">
                        <span style="padding: 4px 12px; background: ${config.primary_action_color || defaultConfig.primary_action_color}; color: white; border-radius: 12px; font-size: ${baseSize * 0.8}px; font-weight: 600;">${stats.activeDeadlines}</span>
                      </td>
                      <td style="padding: 16px; text-align: center;">
                        <span style="padding: 4px 12px; background: #10b981; color: white; border-radius: 12px; font-size: ${baseSize * 0.8}px; font-weight: 600;">${stats.completedDeadlines}</span>
                      </td>
                      <td style="padding: 16px; text-align: center;">
                        <span style="padding: 4px 12px; background: ${user.status === 'active' ? '#10b981' : '#ef4444'}; color: white; border-radius: 12px; font-size: ${baseSize * 0.8}px; font-weight: 600;">${user.status === 'active' ? 'Aktif' : 'Nonaktif'}</span>
                      </td>
                      <td style="padding: 16px; text-align: center;">
                        <div style="display: flex; gap: 8px; justify-content: center;">
                          <button class="admin-edit-user" data-id="${user.id}" style="padding: 6px 12px; background: ${config.secondary_action_color || defaultConfig.secondary_action_color}; color: white; border: none; border-radius: 6px; font-size: ${baseSize * 0.8}px; cursor: pointer;">Edit</button>
                          <button class="admin-delete-user" data-id="${user.id}" style="padding: 6px 12px; background: #ef4444; color: white; border: none; border-radius: 6px; font-size: ${baseSize * 0.8}px; cursor: pointer;">Hapus</button>
                        </div>
                      </td>
                    </tr>
                  `}).join('')}
                </tbody>
              </table>
            </div>
          </div>
        </div>
      `;
    }

    function renderAdminBroadcast() {
      const config = window.elementSdk?.config || defaultConfig;
      const baseSize = config.font_size || defaultConfig.font_size;

      return `
        <div class="fade-in">
          <h2 style="font-size: ${baseSize * 1.5}px; font-weight: 700; color: ${config.text_color || defaultConfig.text_color}; margin-bottom: 24px;">Broadcast Notifikasi</h2>

          <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 24px;">
            <div style="background: ${config.surface_color || defaultConfig.surface_color}; padding: 24px; border-radius: 12px; box-shadow: 0 2px 4px rgba(0, 0, 0, 0.05);">
              <h3 style="font-size: ${baseSize * 1.2}px; font-weight: 600; color: ${config.text_color || defaultConfig.text_color}; margin-bottom: 20px;">Kirim Notifikasi Broadcast</h3>
              
              <form id="broadcast-form">
                <div style="margin-bottom: 16px;">
                  <label for="broadcast-target" style="display: block; font-size: ${baseSize * 0.9}px; font-weight: 500; color: ${config.text_color || defaultConfig.text_color}; margin-bottom: 8px;">Target</label>
                  <select id="broadcast-target" style="width: 100%; padding: 10px; border: 2px solid #e2e8f0; border-radius: 8px; font-size: ${baseSize * 0.9}px; outline: none; cursor: pointer;">
                    <option value="all">Semua User</option>
                    <option value="active">User Aktif</option>
                    <option value="inactive">User Tidak Aktif</option>
                    <option value="custom">Pilih User Spesifik</option>
                  </select>
                </div>

                <!-- Custom User Selection -->
                <div id="custom-user-selection" style="display: none; margin-bottom: 16px; padding: 16px; background: ${config.background_color || defaultConfig.background_color}; border-radius: 8px; max-height: 300px; overflow-y: auto;">
                  <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 12px;">
                    <label style="font-size: ${baseSize * 0.9}px; font-weight: 600; color: ${config.text_color || defaultConfig.text_color};">Pilih Penerima:</label>
                    <div style="display: flex; gap: 8px;">
                      <button type="button" id="select-all-users" style="padding: 4px 12px; background: ${config.primary_action_color || defaultConfig.primary_action_color}; color: white; border: none; border-radius: 6px; font-size: ${baseSize * 0.75}px; cursor: pointer;">Pilih Semua</button>
                      <button type="button" id="deselect-all-users" style="padding: 4px 12px; background: ${config.secondary_action_color || defaultConfig.secondary_action_color}; color: white; border: none; border-radius: 6px; font-size: ${baseSize * 0.75}px; cursor: pointer;">Hapus Semua</button>
                    </div>
                  </div>
                  <div id="user-checkboxes" style="display: flex; flex-direction: column; gap: 8px;">
                    ${users.map(user => {
        const stats = getUserStats(user.id);
        return `
                        <label style="display: flex; align-items: center; gap: 12px; padding: 10px; background: white; border-radius: 6px; cursor: pointer; transition: all 0.2s; border: 2px solid transparent;" onmouseover="this.style.borderColor='${config.primary_action_color || defaultConfig.primary_action_color}'" onmouseout="this.style.borderColor='transparent'">
                          <input type="checkbox" class="user-checkbox" value="${user.id}" style="width: 18px; height: 18px; cursor: pointer;">
                          <div style="flex: 1;">
                            <div style="font-size: ${baseSize * 0.85}px; font-weight: 600; color: ${config.text_color || defaultConfig.text_color};">${user.name}</div>
                            <div style="font-size: ${baseSize * 0.75}px; color: ${config.secondary_action_color || defaultConfig.secondary_action_color};">${user.email}</div>
                          </div>
                          <div style="display: flex; gap: 4px;">
                            <span style="padding: 2px 8px; background: ${user.status === 'active' ? '#d1fae5' : '#fee2e2'}; color: ${user.status === 'active' ? '#065f46' : '#991b1b'}; border-radius: 10px; font-size: ${baseSize * 0.7}px; font-weight: 600;">${user.status === 'active' ? 'Aktif' : 'Nonaktif'}</span>
                            <span style="padding: 2px 8px; background: #dbeafe; color: #1e40af; border-radius: 10px; font-size: ${baseSize * 0.7}px; font-weight: 600;">${stats.activeDeadlines + stats.completedDeadlines} deadline</span>
                          </div>
                        </label>
                      `;
      }).join('')}
                  </div>
                  <div id="selected-count" style="margin-top: 12px; padding: 8px 12px; background: #dbeafe; border-radius: 6px; font-size: ${baseSize * 0.8}px; font-weight: 600; color: #1e40af; text-align: center;">
                    0 user dipilih
                  </div>
                </div>

                <div style="margin-bottom: 16px;">
                  <label for="broadcast-title" style="display: block; font-size: ${baseSize * 0.9}px; font-weight: 500; color: ${config.text_color || defaultConfig.text_color}; margin-bottom: 8px;">Judul Notifikasi</label>
                  <input type="text" id="broadcast-title" required style="width: 100%; padding: 10px; border: 2px solid #e2e8f0; border-radius: 8px; font-size: ${baseSize * 0.9}px; outline: none;" placeholder="Contoh: Update Sistem">
                </div>

                <div style="margin-bottom: 20px;">
                  <label for="broadcast-message" style="display: block; font-size: ${baseSize * 0.9}px; font-weight: 500; color: ${config.text_color || defaultConfig.text_color}; margin-bottom: 8px;">Pesan</label>
                  <textarea id="broadcast-message" rows="4" required style="width: 100%; padding: 10px; border: 2px solid #e2e8f0; border-radius: 8px; font-size: ${baseSize * 0.9}px; outline: none; resize: vertical;" placeholder="Tulis pesan broadcast..."></textarea>
                </div>

                <button type="submit" id="send-broadcast-btn" style="width: 100%; padding: 12px; background: ${config.primary_action_color || defaultConfig.primary_action_color}; color: white; border: none; border-radius: 8px; font-size: ${baseSize}px; font-weight: 600; cursor: pointer;">
                  üì¢ Kirim Broadcast
                </button>
              </form>
            </div>

            <div style="background: ${config.surface_color || defaultConfig.surface_color}; padding: 24px; border-radius: 12px; box-shadow: 0 2px 4px rgba(0, 0, 0, 0.05);">
              <h3 style="font-size: ${baseSize * 1.2}px; font-weight: 600; color: ${config.text_color || defaultConfig.text_color}; margin-bottom: 20px;">Riwayat Broadcast</h3>
              
              <div style="display: flex; flex-direction: column; gap: 12px; max-height: 400px; overflow-y: auto;">
                ${broadcastMessages.length === 0 ? `
                  <div style="text-align: center; padding: 40px 20px;">
                    <p style="font-size: ${baseSize * 0.9}px; color: ${config.secondary_action_color || defaultConfig.secondary_action_color};">Belum ada riwayat broadcast</p>
                  </div>
                ` : broadcastMessages.slice().reverse().slice(0, 10).map(broadcast => `
                  <div style="padding: 12px; background: ${config.background_color || defaultConfig.background_color}; border-radius: 8px; border-left: 4px solid ${config.primary_action_color || defaultConfig.primary_action_color};">
                    <div style="display: flex; justify-content: space-between; align-items: start; margin-bottom: 4px;">
                      <p style="font-size: ${baseSize * 0.85}px; font-weight: 600; color: ${config.text_color || defaultConfig.text_color}; margin: 0;">${broadcast.title}</p>
                      <span style="padding: 2px 8px; background: #10b981; color: white; border-radius: 8px; font-size: ${baseSize * 0.7}px;">${broadcast.recipientCount} user</span>
                    </div>
                    <p style="font-size: ${baseSize * 0.8}px; color: ${config.text_color || defaultConfig.text_color}; margin: 4px 0;">${broadcast.message}</p>
                    <p style="font-size: ${baseSize * 0.75}px; color: ${config.secondary_action_color || defaultConfig.secondary_action_color}; margin: 4px 0 0 0;">${new Date(broadcast.sentAt).toLocaleString('id-ID')}</p>
                  </div>
                `).join('')}
              </div>
            </div>
          </div>
        </div>
      `;
    }

    function renderAdminReports() {
      const config = window.elementSdk?.config || defaultConfig;
      const baseSize = config.font_size || defaultConfig.font_size;

      // Calculate overall statistics
      const totalUsers = users.length;
      const activeUsers = users.filter(u => u.status === 'active').length;
      const inactiveUsers = users.filter(u => u.status === 'inactive').length;
      const totalDeadlines = deadlines.length;
      const completedDeadlines = deadlines.filter(d => d.completed).length;
      const activeDeadlines = deadlines.filter(d => !d.completed).length;

      // Calculate user activity
      const usersWithActivity = users.map(user => {
        const userDeadlines = deadlines.filter(d => d.userId === user.id);
        return {
          ...user,
          totalDeadlines: userDeadlines.length,
          activeDeadlines: userDeadlines.filter(d => !d.completed).length,
          completedDeadlines: userDeadlines.filter(d => d.completed).length,
          completionRate: userDeadlines.length > 0 ? Math.round((userDeadlines.filter(d => d.completed).length / userDeadlines.length) * 100) : 0
        };
      }).sort((a, b) => b.totalDeadlines - a.totalDeadlines);

      // Calculate priority distribution
      const highPriority = deadlines.filter(d => d.priority === 'high').length;
      const mediumPriority = deadlines.filter(d => d.priority === 'medium').length;
      const lowPriority = deadlines.filter(d => d.priority === 'low').length;

      // Calculate completion rate
      const overallCompletionRate = totalDeadlines > 0 ? Math.round((completedDeadlines / totalDeadlines) * 100) : 0;

      return `
        <div class="fade-in">
          <h2 style="font-size: ${baseSize * 1.5}px; font-weight: 700; color: ${config.text_color || defaultConfig.text_color}; margin-bottom: 24px;">Laporan Penggunaan Sistem</h2>

          <!-- Overall Statistics Cards -->
          <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 16px; margin-bottom: 24px;">
            <div style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); padding: 20px; border-radius: 12px; color: white; box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);">
              <div style="font-size: ${baseSize * 0.85}px; opacity: 0.9; margin-bottom: 8px;">Total User</div>
              <div style="font-size: ${baseSize * 2.2}px; font-weight: 700;">${totalUsers}</div>
              <div style="font-size: ${baseSize * 0.75}px; opacity: 0.8; margin-top: 4px;">${activeUsers} aktif, ${inactiveUsers} nonaktif</div>
            </div>

            <div style="background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%); padding: 20px; border-radius: 12px; color: white; box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);">
              <div style="font-size: ${baseSize * 0.85}px; opacity: 0.9; margin-bottom: 8px;">Total Deadline</div>
              <div style="font-size: ${baseSize * 2.2}px; font-weight: 700;">${totalDeadlines}</div>
              <div style="font-size: ${baseSize * 0.75}px; opacity: 0.8; margin-top: 4px;">${activeDeadlines} aktif, ${completedDeadlines} selesai</div>
            </div>

            <div style="background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%); padding: 20px; border-radius: 12px; color: white; box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);">
              <div style="font-size: ${baseSize * 0.85}px; opacity: 0.9; margin-bottom: 8px;">Tingkat Penyelesaian</div>
              <div style="font-size: ${baseSize * 2.2}px; font-weight: 700;">${overallCompletionRate}%</div>
              <div style="font-size: ${baseSize * 0.75}px; opacity: 0.8; margin-top: 4px;">dari semua deadline</div>
            </div>

            <div style="background: linear-gradient(135deg, #43e97b 0%, #38f9d7 100%); padding: 20px; border-radius: 12px; color: white; box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);">
              <div style="font-size: ${baseSize * 0.85}px; opacity: 0.9; margin-bottom: 8px;">Rata-rata per User</div>
              <div style="font-size: ${baseSize * 2.2}px; font-weight: 700;">${totalUsers > 0 ? (totalDeadlines / totalUsers).toFixed(1) : 0}</div>
              <div style="font-size: ${baseSize * 0.75}px; opacity: 0.8; margin-top: 4px;">deadline per user</div>
            </div>
          </div>

          <!-- Priority Distribution -->
          <div style="background: ${config.surface_color || defaultConfig.surface_color}; padding: 24px; border-radius: 12px; box-shadow: 0 2px 4px rgba(0, 0, 0, 0.05); margin-bottom: 24px;">
            <h3 style="font-size: ${baseSize * 1.2}px; font-weight: 600; color: ${config.text_color || defaultConfig.text_color}; margin-bottom: 20px;">Distribusi Prioritas Deadline</h3>
            
            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); gap: 16px;">
              <div style="text-align: center; padding: 16px; background: ${config.background_color || defaultConfig.background_color}; border-radius: 8px;">
                <div style="font-size: ${baseSize * 2}px; margin-bottom: 8px;">üî¥</div>
                <div style="font-size: ${baseSize * 1.8}px; font-weight: 700; color: #ef4444; margin-bottom: 4px;">${highPriority}</div>
                <div style="font-size: ${baseSize * 0.85}px; color: ${config.secondary_action_color || defaultConfig.secondary_action_color};">Prioritas Tinggi</div>
              </div>

              <div style="text-align: center; padding: 16px; background: ${config.background_color || defaultConfig.background_color}; border-radius: 8px;">
                <div style="font-size: ${baseSize * 2}px; margin-bottom: 8px;">üü°</div>
                <div style="font-size: ${baseSize * 1.8}px; font-weight: 700; color: #f59e0b; margin-bottom: 4px;">${mediumPriority}</div>
                <div style="font-size: ${baseSize * 0.85}px; color: ${config.secondary_action_color || defaultConfig.secondary_action_color};">Prioritas Sedang</div>
              </div>

              <div style="text-align: center; padding: 16px; background: ${config.background_color || defaultConfig.background_color}; border-radius: 8px;">
                <div style="font-size: ${baseSize * 2}px; margin-bottom: 8px;">üü¢</div>
                <div style="font-size: ${baseSize * 1.8}px; font-weight: 700; color: #10b981; margin-bottom: 4px;">${lowPriority}</div>
                <div style="font-size: ${baseSize * 0.85}px; color: ${config.secondary_action_color || defaultConfig.secondary_action_color};">Prioritas Rendah</div>
              </div>
            </div>
          </div>

          <!-- User Activity Table -->
          <div style="background: ${config.surface_color || defaultConfig.surface_color}; padding: 24px; border-radius: 12px; box-shadow: 0 2px 4px rgba(0, 0, 0, 0.05);">
            <h3 style="font-size: ${baseSize * 1.2}px; font-weight: 600; color: ${config.text_color || defaultConfig.text_color}; margin-bottom: 20px;">Aktivitas User</h3>
            
            ${usersWithActivity.length === 0 ? `
              <div style="text-align: center; padding: 40px 20px;">
                <p style="font-size: ${baseSize}px; color: ${config.secondary_action_color || defaultConfig.secondary_action_color};">Belum ada data aktivitas user</p>
              </div>
            ` : `
              <div style="overflow-x: auto;">
                <table style="width: 100%; border-collapse: collapse;">
                  <thead style="background: ${config.background_color || defaultConfig.background_color};">
                    <tr>
                      <th style="padding: 12px 16px; text-align: left; font-size: ${baseSize * 0.85}px; font-weight: 600; color: ${config.text_color || defaultConfig.text_color};">Nama User</th>
                      <th style="padding: 12px 16px; text-align: center; font-size: ${baseSize * 0.85}px; font-weight: 600; color: ${config.text_color || defaultConfig.text_color};">Status</th>
                      <th style="padding: 12px 16px; text-align: center; font-size: ${baseSize * 0.85}px; font-weight: 600; color: ${config.text_color || defaultConfig.text_color};">Total Deadline</th>
                      <th style="padding: 12px 16px; text-align: center; font-size: ${baseSize * 0.85}px; font-weight: 600; color: ${config.text_color || defaultConfig.text_color};">Aktif</th>
                      <th style="padding: 12px 16px; text-align: center; font-size: ${baseSize * 0.85}px; font-weight: 600; color: ${config.text_color || defaultConfig.text_color};">Selesai</th>
                      <th style="padding: 12px 16px; text-align: center; font-size: ${baseSize * 0.85}px; font-weight: 600; color: ${config.text_color || defaultConfig.text_color};">Tingkat Penyelesaian</th>
                    </tr>
                  </thead>
                  <tbody>
                    ${usersWithActivity.map(user => `
                      <tr style="border-top: 1px solid #e2e8f0;">
                        <td style="padding: 12px 16px;">
                          <div style="font-size: ${baseSize * 0.9}px; font-weight: 600; color: ${config.text_color || defaultConfig.text_color};">${user.name}</div>
                          <div style="font-size: ${baseSize * 0.75}px; color: ${config.secondary_action_color || defaultConfig.secondary_action_color};">${user.email}</div>
                        </td>
                        <td style="padding: 12px 16px; text-align: center;">
                          <span style="padding: 4px 12px; background: ${user.status === 'active' ? '#d1fae5' : '#fee2e2'}; color: ${user.status === 'active' ? '#065f46' : '#991b1b'}; border-radius: 12px; font-size: ${baseSize * 0.75}px; font-weight: 600;">${user.status === 'active' ? 'Aktif' : 'Nonaktif'}</span>
                        </td>
                        <td style="padding: 12px 16px; text-align: center;">
                          <span style="font-size: ${baseSize * 0.9}px; font-weight: 700; color: ${config.text_color || defaultConfig.text_color};">${user.totalDeadlines}</span>
                        </td>
                        <td style="padding: 12px 16px; text-align: center;">
                          <span style="padding: 4px 10px; background: #dbeafe; color: #1e40af; border-radius: 10px; font-size: ${baseSize * 0.8}px; font-weight: 600;">${user.activeDeadlines}</span>
                        </td>
                        <td style="padding: 12px 16px; text-align: center;">
                          <span style="padding: 4px 10px; background: #d1fae5; color: #065f46; border-radius: 10px; font-size: ${baseSize * 0.8}px; font-weight: 600;">${user.completedDeadlines}</span>
                        </td>
                        <td style="padding: 12px 16px; text-align: center;">
                          <div style="display: flex; align-items: center; justify-content: center; gap: 8px;">
                            <div style="flex: 1; max-width: 80px; height: 8px; background: #e2e8f0; border-radius: 4px; overflow: hidden;">
                              <div style="height: 100%; background: ${user.completionRate >= 70 ? '#10b981' : user.completionRate >= 40 ? '#f59e0b' : '#ef4444'}; width: ${user.completionRate}%; transition: width 0.3s;"></div>
                            </div>
                            <span style="font-size: ${baseSize * 0.85}px; font-weight: 600; color: ${config.text_color || defaultConfig.text_color}; min-width: 40px;">${user.completionRate}%</span>
                          </div>
                        </td>
                      </tr>
                    `).join('')}
                  </tbody>
                </table>
              </div>
            `}
          </div>
        </div>
      `;
    }

    function renderDashboard() {
      const config = window.elementSdk?.config || defaultConfig;
      const customFont = config.font_family || defaultConfig.font_family;
      const baseFontStack = 'system-ui, -apple-system, sans-serif';
      const baseSize = config.font_size || defaultConfig.font_size;

      const stats = calculateStats();
      const filteredDeadlines = getFilteredDeadlines();

      return `
        <div class="w-full h-full" style="background: ${config.background_color || defaultConfig.background_color}; font-family: ${customFont}, ${baseFontStack}; overflow-y: auto;">
          ${renderSidebar()}
          ${renderNavbar()}

          <div style="max-width: 1400px; margin: 0 auto; padding: 24px;">
            <!-- Statistics Cards -->
            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 16px; margin-bottom: 24px;" class="fade-in">
              <div style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); padding: 20px; border-radius: 12px; color: white; box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);">
                <div style="font-size: ${baseSize * 0.85}px; opacity: 0.9; margin-bottom: 8px;">Total Deadline</div>
                <div style="font-size: ${baseSize * 2.2}px; font-weight: 700;">${stats.total}</div>
              </div>

              <div style="background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%); padding: 20px; border-radius: 12px; color: white; box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);">
                <div style="font-size: ${baseSize * 0.85}px; opacity: 0.9; margin-bottom: 8px;">Deadline Aktif</div>
                <div style="font-size: ${baseSize * 2.2}px; font-weight: 700;">${stats.active}</div>
              </div>

              <div style="background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%); padding: 20px; border-radius: 12px; color: white; box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);">
                <div style="font-size: ${baseSize * 0.85}px; opacity: 0.9; margin-bottom: 8px;">Selesai</div>
                <div style="font-size: ${baseSize * 2.2}px; font-weight: 700;">${stats.completed}</div>
              </div>
            </div>

            <!-- Filters and Search -->
            <div style="background: ${config.surface_color || defaultConfig.surface_color}; padding: 20px; border-radius: 12px; margin-bottom: 24px; box-shadow: 0 2px 4px rgba(0, 0, 0, 0.05);">
              <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 16px;">
                <div>
                  <label for="search-input" style="display: block; font-size: ${baseSize * 0.85}px; font-weight: 500; color: ${config.text_color || defaultConfig.text_color}; margin-bottom: 8px;">Cari Deadline</label>
                  <input type="text" id="search-input" placeholder="Cari judul atau deskripsi..." style="width: 100%; padding: 10px 12px; border: 2px solid #e2e8f0; border-radius: 8px; font-size: ${baseSize * 0.9}px; outline: none;">
                </div>

                <div>
                  <label for="filter-status" style="display: block; font-size: ${baseSize * 0.85}px; font-weight: 500; color: ${config.text_color || defaultConfig.text_color}; margin-bottom: 8px;">Status</label>
                  <select id="filter-status" style="width: 100%; padding: 10px 12px; border: 2px solid #e2e8f0; border-radius: 8px; font-size: ${baseSize * 0.9}px; outline: none; cursor: pointer;">
                    <option value="all" ${filterStatus === 'all' ? 'selected' : ''}>Semua Status</option>
                    <option value="active" ${filterStatus === 'active' ? 'selected' : ''}>Aktif</option>
                    <option value="completed" ${filterStatus === 'completed' ? 'selected' : ''}>Selesai</option>
                  </select>
                </div>

                <div>
                  <label for="filter-priority" style="display: block; font-size: ${baseSize * 0.85}px; font-weight: 500; color: ${config.text_color || defaultConfig.text_color}; margin-bottom: 8px;">Prioritas</label>
                  <select id="filter-priority" style="width: 100%; padding: 10px 12px; border: 2px solid #e2e8f0; border-radius: 8px; font-size: ${baseSize * 0.9}px; outline: none; cursor: pointer;">
                    <option value="all" ${filterPriority === 'all' ? 'selected' : ''}>Semua Prioritas</option>
                    <option value="high" ${filterPriority === 'high' ? 'selected' : ''}>Tinggi</option>
                    <option value="medium" ${filterPriority === 'medium' ? 'selected' : ''}>Sedang</option>
                    <option value="low" ${filterPriority === 'low' ? 'selected' : ''}>Rendah</option>
                  </select>
                </div>
              </div>
            </div>

            <!-- Add Deadline Button -->
            <div style="margin-bottom: 24px;">
              <button id="add-deadline-btn" style="width: 100%; padding: 16px; background: ${config.primary_action_color || defaultConfig.primary_action_color}; color: white; border: none; border-radius: 12px; font-size: ${baseSize}px; font-weight: 600; cursor: pointer; display: flex; align-items: center; justify-content: center; gap: 8px; transition: all 0.2s; box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);">
                <span style="font-size: ${baseSize * 1.5}px;">+</span>
                ${config.button_text || defaultConfig.button_text}
              </button>
            </div>

            <!-- Deadlines List -->
            <div id="deadlines-container" style="display: flex; flex-direction: column; gap: 16px;">
              ${filteredDeadlines.length === 0 ? `
                <div style="text-align: center; padding: 60px 20px; background: ${config.surface_color || defaultConfig.surface_color}; border-radius: 12px;">
                  <div style="font-size: ${baseSize * 4}px; margin-bottom: 16px;">üìã</div>
                  <p style="font-size: ${baseSize * 1.2}px; font-weight: 600; color: ${config.text_color || defaultConfig.text_color}; margin-bottom: 8px;">Belum ada deadline</p>
                  <p style="font-size: ${baseSize * 0.9}px; color: ${config.secondary_action_color || defaultConfig.secondary_action_color};">Klik tombol di atas untuk menambah deadline baru</p>
                </div>
              ` : filteredDeadlines.map(deadline => {
        const daysLeft = calculateDaysLeft(deadline.date);
        const isOverdue = daysLeft < 0 && !deadline.completed;

        return `
                  <div class="slide-in priority-${deadline.priority}" style="background: ${config.surface_color || defaultConfig.surface_color}; padding: 20px; border-radius: 12px; box-shadow: 0 2px 4px rgba(0, 0, 0, 0.05); ${deadline.completed ? 'opacity: 0.7;' : ''}">
                    <div style="display: flex; justify-content: space-between; align-items: start; gap: 16px; margin-bottom: 12px;">
                      <div style="flex: 1;">
                        <h3 style="font-size: ${baseSize * 1.2}px; font-weight: 600; color: ${config.text_color || defaultConfig.text_color}; margin-bottom: 8px; ${deadline.completed ? 'text-decoration: line-through;' : ''}">${deadline.title}</h3>
                        <p style="font-size: ${baseSize * 0.9}px; color: ${config.secondary_action_color || defaultConfig.secondary_action_color}; margin-bottom: 12px;">${deadline.description}</p>
                        
                        <div style="display: flex; flex-wrap: wrap; gap: 8px; align-items: center;">
                          <span style="padding: 4px 12px; background: ${getPriorityColor(deadline.priority)}15; color: ${getPriorityColor(deadline.priority)}; border-radius: 12px; font-size: ${baseSize * 0.8}px; font-weight: 600;">
                            ${getPriorityLabel(deadline.priority)}
                          </span>
                          
                          <span style="padding: 4px 12px; background: ${config.background_color || defaultConfig.background_color}; color: ${config.text_color || defaultConfig.text_color}; border-radius: 12px; font-size: ${baseSize * 0.8}px;">
                            üìÖ ${formatDate(deadline.date)}
                          </span>
                          
                          ${!deadline.completed ? `
                            <span style="padding: 4px 12px; background: ${isOverdue ? '#fee2e2' : '#dbeafe'}; color: ${isOverdue ? '#991b1b' : '#1e40af'}; border-radius: 12px; font-size: ${baseSize * 0.8}px; font-weight: 600;">
                              ${isOverdue ? `‚ö†Ô∏è Terlambat ${Math.abs(daysLeft)} hari` : daysLeft === 0 ? 'üîî Hari ini!' : `‚è∞ ${daysLeft} hari lagi`}
                            </span>
                          ` : ''}
                          
                          ${deadline.completed ? `
                            <span style="padding: 4px 12px; background: #d1fae5; color: #065f46; border-radius: 12px; font-size: ${baseSize * 0.8}px; font-weight: 600;">
                              ‚úì Selesai
                            </span>
                          ` : ''}
                        </div>
                      </div>
                      
                      <div style="display: flex; gap: 8px;">
                        ${!deadline.completed ? `
                          <button class="complete-btn" data-id="${deadline.__backendId}" style="padding: 8px 16px; background: #10b981; color: white; border: none; border-radius: 8px; font-size: ${baseSize * 0.85}px; cursor: pointer; white-space: nowrap;">
                            ‚úì Selesai
                          </button>
                        ` : ''}
                        <button class="delete-btn" data-id="${deadline.__backendId}" style="padding: 8px 16px; background: #ef4444; color: white; border: none; border-radius: 8px; font-size: ${baseSize * 0.85}px; cursor: pointer;">
                          üóëÔ∏è
                        </button>
                      </div>
                    </div>
                  </div>
                `;
      }).join('')}
            </div>
          </div>
        </div>
      `;
    }

    function renderSidebar() {
      const config = window.elementSdk?.config || defaultConfig;
      const baseSize = config.font_size || defaultConfig.font_size;

      return `
        <div id="sidebar-overlay" class="sidebar-overlay"></div>
        <div id="sidebar" class="sidebar" style="background: ${config.surface_color || defaultConfig.surface_color};">
          <div style="padding: 24px;">
            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 32px;">
              <h3 style="font-size: ${baseSize * 1.3}px; font-weight: 700; color: ${config.text_color || defaultConfig.text_color}; margin: 0;">Menu</h3>
              <button id="close-sidebar" style="background: none; border: none; font-size: ${baseSize * 1.5}px; color: ${config.secondary_action_color || defaultConfig.secondary_action_color}; cursor: pointer; padding: 0; width: 32px; height: 32px; display: flex; align-items: center; justify-content: center;">√ó</button>
            </div>

            <div style="display: flex; flex-direction: column; gap: 8px;">
              <button id="sidebar-dashboard" class="sidebar-nav-btn" style="width: 100%; padding: 14px 16px; background: ${currentView === 'dashboard' ? config.primary_action_color || defaultConfig.primary_action_color : 'transparent'}; color: ${currentView === 'dashboard' ? 'white' : config.text_color || defaultConfig.text_color}; border: none; border-radius: 8px; font-size: ${baseSize}px; font-weight: 600; cursor: pointer; text-align: left; display: flex; align-items: center; gap: 12px; transition: all 0.2s;">
                <span style="font-size: ${baseSize * 1.2}px;">üìã</span>
                Dashboard
              </button>

              <button id="sidebar-calendar" class="sidebar-nav-btn" style="width: 100%; padding: 14px 16px; background: ${currentView === 'calendar' ? config.primary_action_color || defaultConfig.primary_action_color : 'transparent'}; color: ${currentView === 'calendar' ? 'white' : config.text_color || defaultConfig.text_color}; border: none; border-radius: 8px; font-size: ${baseSize}px; font-weight: 600; cursor: pointer; text-align: left; display: flex; align-items: center; gap: 12px; transition: all 0.2s;">
                <span style="font-size: ${baseSize * 1.2}px;">üìÖ</span>
                Kalender
              </button>

              <button id="sidebar-statistics" class="sidebar-nav-btn" style="width: 100%; padding: 14px 16px; background: ${currentView === 'statistics' ? config.primary_action_color || defaultConfig.primary_action_color : 'transparent'}; color: ${currentView === 'statistics' ? 'white' : config.text_color || defaultConfig.text_color}; border: none; border-radius: 8px; font-size: ${baseSize}px; font-weight: 600; cursor: pointer; text-align: left; display: flex; align-items: center; gap: 12px; transition: all 0.2s;">
                <span style="font-size: ${baseSize * 1.2}px;">üìä</span>
                Statistik
              </button>

              <button id="sidebar-notifications" class="sidebar-nav-btn" style="width: 100%; padding: 14px 16px; background: ${currentView === 'notifications' ? config.primary_action_color || defaultConfig.primary_action_color : 'transparent'}; color: ${currentView === 'notifications' ? 'white' : config.text_color || defaultConfig.text_color}; border: none; border-radius: 8px; font-size: ${baseSize}px; font-weight: 600; cursor: pointer; text-align: left; display: flex; align-items: center; gap: 12px; transition: all 0.2s; position: relative;">
                <span style="font-size: ${baseSize * 1.2}px;">üîî</span>
                Notifikasi
                ${notificationLogs.filter(n => n.userId === currentUser?.id && !n.read).length > 0 ? `
                  <span style="position: absolute; right: 12px; top: 50%; transform: translateY(-50%); padding: 2px 8px; background: #ef4444; color: white; border-radius: 10px; font-size: ${baseSize * 0.7}px; font-weight: 700;">
                    ${notificationLogs.filter(n => n.userId === currentUser?.id && !n.read).length}
                  </span>
                ` : ''}
              </button>

              <button id="sidebar-profile" class="sidebar-nav-btn" style="width: 100%; padding: 14px 16px; background: ${currentView === 'profile' ? config.primary_action_color || defaultConfig.primary_action_color : 'transparent'}; color: ${currentView === 'profile' ? 'white' : config.text_color || defaultConfig.text_color}; border: none; border-radius: 8px; font-size: ${baseSize}px; font-weight: 600; cursor: pointer; text-align: left; display: flex; align-items: center; gap: 12px; transition: all 0.2s;">
                <span style="font-size: ${baseSize * 1.2}px;">üë§</span>
                Profil
              </button>
            </div>

            <hr style="border: none; border-top: 1px solid #e2e8f0; margin: 16px 0;">

            <button id="sidebar-logout" style="width: 100%; padding: 14px 16px; background: transparent; color: #ef4444; border: none; border-radius: 8px; font-size: ${baseSize}px; font-weight: 600; cursor: pointer; text-align: left; display: flex; align-items: center; gap: 12px; transition: all 0.2s;">
              <span style="font-size: ${baseSize * 1.2}px;">üö™</span>
              Keluar
            </button>

            <div style="margin-top: 24px; padding: 16px; background: ${config.background_color || defaultConfig.background_color}; border-radius: 8px;">
              <p style="font-size: ${baseSize * 0.85}px; color: ${config.secondary_action_color || defaultConfig.secondary_action_color}; margin: 0;">
                <strong style="color: ${config.text_color || defaultConfig.text_color};">${currentUser?.name || 'User'}</strong><br>
                ${currentUser?.email || ''}
              </p>
            </div>
          </div>
        </div>
      `;
    }

    function renderNavbar() {
      const config = window.elementSdk?.config || defaultConfig;
      const baseSize = config.font_size || defaultConfig.font_size;

      const unreadNotifs = notificationLogs.filter(n => n.userId === currentUser?.id && !n.read).length;

      return `
        <nav style="background: ${config.surface_color || defaultConfig.surface_color}; box-shadow: 0 2px 4px rgba(0, 0, 0, 0.05); padding: 16px 24px;">
          <div style="max-width: 1400px; margin: 0 auto; display: flex; justify-content: space-between; align-items: center; gap: 16px;">
            <div style="display: flex; align-items: center; gap: 16px;">
              <button id="menu-toggle" class="hamburger" style="background: none; border: none; color: ${config.text_color || defaultConfig.text_color}; padding: 0;">
                <span></span>
                <span></span>
                <span></span>
              </button>
              <h1 style="font-size: ${baseSize * 1.5}px; font-weight: 700; color: ${config.text_color || defaultConfig.text_color}; margin: 0;">${config.app_title || defaultConfig.app_title}</h1>
            </div>

            <button id="notif-bell" style="position: relative; background: ${config.background_color || defaultConfig.background_color}; border: none; border-radius: 50%; width: 44px; height: 44px; display: flex; align-items: center; justify-content: center; cursor: pointer; font-size: ${baseSize * 1.3}px;">
              üîî
              ${unreadNotifs > 0 ? `
                <span style="position: absolute; top: 4px; right: 4px; width: 20px; height: 20px; background: #ef4444; color: white; border-radius: 50%; font-size: ${baseSize * 0.65}px; font-weight: 700; display: flex; align-items: center; justify-content: center; border: 2px solid ${config.surface_color || defaultConfig.surface_color};">
                  ${unreadNotifs > 9 ? '9+' : unreadNotifs}
                </span>
              ` : ''}
            </button>
          </div>
        </nav>
      `;
    }

    function renderCalendar() {
      return '<div style="padding: 24px;">Kalender View (Coming Soon)</div>';
    }

    function renderProfile() {
      return '<div style="padding: 24px;">Profile View (Coming Soon)</div>';
    }

    function renderNotifications() {
      const config = window.elementSdk?.config || defaultConfig;
      const baseSize = config.font_size || defaultConfig.font_size;

      const userNotifications = notificationLogs.filter(n => n.userId === currentUser?.id).reverse();

      return `
        <div class="w-full h-full" style="background: ${config.background_color || defaultConfig.background_color}; overflow-y: auto;">
          ${renderSidebar()}
          ${renderNavbar()}

          <div style="max-width: 1400px; margin: 0 auto; padding: 24px;">
            <h2 style="font-size: ${baseSize * 1.5}px; font-weight: 700; color: ${config.text_color || defaultConfig.text_color}; margin-bottom: 24px;">Notifikasi Saya</h2>

            ${userNotifications.length === 0 ? `
              <div style="text-align: center; padding: 60px 20px; background: ${config.surface_color || defaultConfig.surface_color}; border-radius: 12px;">
                <div style="font-size: ${baseSize * 4}px; margin-bottom: 16px;">üîî</div>
                <p style="font-size: ${baseSize * 1.2}px; font-weight: 600; color: ${config.text_color || defaultConfig.text_color}; margin-bottom: 8px;">Belum ada notifikasi</p>
                <p style="font-size: ${baseSize * 0.9}px; color: ${config.secondary_action_color || defaultConfig.secondary_action_color};">Notifikasi akan muncul di sini</p>
              </div>
            ` : `
              <div style="display: flex; flex-direction: column; gap: 12px;">
                ${userNotifications.map(notif => `
                  <div class="notification-card" data-id="${notif.id}" style="background: ${config.surface_color || defaultConfig.surface_color}; padding: 20px; border-radius: 12px; border-left: 4px solid ${notif.read ? config.secondary_action_color || defaultConfig.secondary_action_color : config.primary_action_color || defaultConfig.primary_action_color}; box-shadow: 0 2px 4px rgba(0, 0, 0, 0.05); cursor: pointer; transition: all 0.2s;">
                    <div style="display: flex; justify-content: space-between; align-items: start; gap: 16px;">
                      <div style="flex: 1;">
                        <div style="display: flex; align-items: center; gap: 8px; margin-bottom: 8px;">
                          ${!notif.read ? `<span style="width: 8px; height: 8px; background: ${config.primary_action_color || defaultConfig.primary_action_color}; border-radius: 50%;"></span>` : ''}
                          <p style="font-size: ${baseSize * 0.9}px; color: ${config.text_color || defaultConfig.text_color}; margin: 0; line-height: 1.5;">${notif.message}</p>
                        </div>
                        <p style="font-size: ${baseSize * 0.75}px; color: ${config.secondary_action_color || defaultConfig.secondary_action_color}; margin: 0;">
                          ${new Date(notif.sentAt).toLocaleString('id-ID')}
                        </p>
                      </div>
                      ${!notif.read ? `
                        <span style="padding: 4px 12px; background: ${config.primary_action_color || defaultConfig.primary_action_color}; color: white; border-radius: 12px; font-size: ${baseSize * 0.75}px; font-weight: 600; white-space: nowrap;">
                          Baru
                        </span>
                      ` : ''}
                    </div>
                  </div>
                `).join('')}
              </div>
            `}
          </div>
        </div>
      `;
    }

    function renderStatistics() {
      return '<div style="padding: 24px;">Statistics View (Coming Soon)</div>';
    }

    function renderAdminMonitoring() {
      const config = window.elementSdk?.config || defaultConfig;
      const baseSize = config.font_size || defaultConfig.font_size;

      // Calculate notification statistics
      const totalNotifications = notificationLogs.length;
      const deliveredNotifications = notificationLogs.filter(n => n.status === 'delivered').length;
      const readNotifications = notificationLogs.filter(n => n.read).length;
      const unreadNotifications = notificationLogs.filter(n => !n.read).length;
      const readRate = totalNotifications > 0 ? Math.round((readNotifications / totalNotifications) * 100) : 0;

      // Get recent notifications (last 50)
      const recentNotifications = notificationLogs.slice().reverse().slice(0, 50);

      // Group notifications by user
      const notificationsByUser = {};
      notificationLogs.forEach(notif => {
        if (!notificationsByUser[notif.userId]) {
          notificationsByUser[notif.userId] = {
            userName: notif.userName,
            total: 0,
            read: 0,
            unread: 0
          };
        }
        notificationsByUser[notif.userId].total++;
        if (notif.read) {
          notificationsByUser[notif.userId].read++;
        } else {
          notificationsByUser[notif.userId].unread++;
        }
      });

      const userStats = Object.entries(notificationsByUser).map(([userId, stats]) => ({
        userId,
        ...stats,
        readRate: stats.total > 0 ? Math.round((stats.read / stats.total) * 100) : 0
      })).sort((a, b) => b.total - a.total);

      return `
        <div class="fade-in">
          <h2 style="font-size: ${baseSize * 1.5}px; font-weight: 700; color: ${config.text_color || defaultConfig.text_color}; margin-bottom: 24px;">Monitoring Notifikasi</h2>

          <!-- Statistics Cards -->
          <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 16px; margin-bottom: 24px;">
            <div style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); padding: 20px; border-radius: 12px; color: white; box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);">
              <div style="font-size: ${baseSize * 0.85}px; opacity: 0.9; margin-bottom: 8px;">Total Notifikasi</div>
              <div style="font-size: ${baseSize * 2.2}px; font-weight: 700;">${totalNotifications}</div>
              <div style="font-size: ${baseSize * 0.75}px; opacity: 0.8; margin-top: 4px;">Semua notifikasi terkirim</div>
            </div>

            <div style="background: linear-gradient(135deg, #43e97b 0%, #38f9d7 100%); padding: 20px; border-radius: 12px; color: white; box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);">
              <div style="font-size: ${baseSize * 0.85}px; opacity: 0.9; margin-bottom: 8px;">Notifikasi Dibaca</div>
              <div style="font-size: ${baseSize * 2.2}px; font-weight: 700;">${readNotifications}</div>
              <div style="font-size: ${baseSize * 0.75}px; opacity: 0.8; margin-top: 4px;">${readRate}% tingkat pembacaan</div>
            </div>

            <div style="background: linear-gradient(135deg, #fa709a 0%, #fee140 100%); padding: 20px; border-radius: 12px; color: white; box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);">
              <div style="font-size: ${baseSize * 0.85}px; opacity: 0.9; margin-bottom: 8px;">Belum Dibaca</div>
              <div style="font-size: ${baseSize * 2.2}px; font-weight: 700;">${unreadNotifications}</div>
              <div style="font-size: ${baseSize * 0.75}px; opacity: 0.8; margin-top: 4px;">Menunggu dibaca user</div>
            </div>

            <div style="background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%); padding: 20px; border-radius: 12px; color: white; box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);">
              <div style="font-size: ${baseSize * 0.85}px; opacity: 0.9; margin-bottom: 8px;">Broadcast Terkirim</div>
              <div style="font-size: ${baseSize * 2.2}px; font-weight: 700;">${broadcastMessages.length}</div>
              <div style="font-size: ${baseSize * 0.75}px; opacity: 0.8; margin-top: 4px;">Total broadcast</div>
            </div>
          </div>

          <!-- User Notification Stats -->
          <div style="background: ${config.surface_color || defaultConfig.surface_color}; padding: 24px; border-radius: 12px; box-shadow: 0 2px 4px rgba(0, 0, 0, 0.05); margin-bottom: 24px;">
            <h3 style="font-size: ${baseSize * 1.2}px; font-weight: 600; color: ${config.text_color || defaultConfig.text_color}; margin-bottom: 20px;">Statistik Notifikasi per User</h3>
            
            ${userStats.length === 0 ? `
              <div style="text-align: center; padding: 40px 20px;">
                <p style="font-size: ${baseSize}px; color: ${config.secondary_action_color || defaultConfig.secondary_action_color};">Belum ada notifikasi terkirim</p>
              </div>
            ` : `
              <div style="overflow-x: auto;">
                <table style="width: 100%; border-collapse: collapse;">
                  <thead style="background: ${config.background_color || defaultConfig.background_color};">
                    <tr>
                      <th style="padding: 12px 16px; text-align: left; font-size: ${baseSize * 0.85}px; font-weight: 600; color: ${config.text_color || defaultConfig.text_color};">Nama User</th>
                      <th style="padding: 12px 16px; text-align: center; font-size: ${baseSize * 0.85}px; font-weight: 600; color: ${config.text_color || defaultConfig.text_color};">Total Notifikasi</th>
                      <th style="padding: 12px 16px; text-align: center; font-size: ${baseSize * 0.85}px; font-weight: 600; color: ${config.text_color || defaultConfig.text_color};">Sudah Dibaca</th>
                      <th style="padding: 12px 16px; text-align: center; font-size: ${baseSize * 0.85}px; font-weight: 600; color: ${config.text_color || defaultConfig.text_color};">Belum Dibaca</th>
                      <th style="padding: 12px 16px; text-align: center; font-size: ${baseSize * 0.85}px; font-weight: 600; color: ${config.text_color || defaultConfig.text_color};">Tingkat Pembacaan</th>
                    </tr>
                  </thead>
                  <tbody>
                    ${userStats.map(stat => `
                      <tr style="border-top: 1px solid #e2e8f0;">
                        <td style="padding: 12px 16px;">
                          <div style="font-size: ${baseSize * 0.9}px; font-weight: 600; color: ${config.text_color || defaultConfig.text_color};">${stat.userName}</div>
                        </td>
                        <td style="padding: 12px 16px; text-align: center;">
                          <span style="padding: 4px 12px; background: #dbeafe; color: #1e40af; border-radius: 12px; font-size: ${baseSize * 0.8}px; font-weight: 600;">${stat.total}</span>
                        </td>
                        <td style="padding: 12px 16px; text-align: center;">
                          <span style="padding: 4px 12px; background: #d1fae5; color: #065f46; border-radius: 12px; font-size: ${baseSize * 0.8}px; font-weight: 600;">${stat.read}</span>
                        </td>
                        <td style="padding: 12px 16px; text-align: center;">
                          <span style="padding: 4px 12px; background: #fee2e2; color: #991b1b; border-radius: 12px; font-size: ${baseSize * 0.8}px; font-weight: 600;">${stat.unread}</span>
                        </td>
                        <td style="padding: 12px 16px; text-align: center;">
                          <div style="display: flex; align-items: center; justify-content: center; gap: 8px;">
                            <div style="flex: 1; max-width: 80px; height: 8px; background: #e2e8f0; border-radius: 4px; overflow: hidden;">
                              <div style="height: 100%; background: ${stat.readRate >= 70 ? '#10b981' : stat.readRate >= 40 ? '#f59e0b' : '#ef4444'}; width: ${stat.readRate}%; transition: width 0.3s;"></div>
                            </div>
                            <span style="font-size: ${baseSize * 0.85}px; font-weight: 600; color: ${config.text_color || defaultConfig.text_color}; min-width: 40px;">${stat.readRate}%</span>
                          </div>
                        </td>
                      </tr>
                    `).join('')}
                  </tbody>
                </table>
              </div>
            `}
          </div>

          <!-- Recent Notifications Log -->
          <div style="background: ${config.surface_color || defaultConfig.surface_color}; padding: 24px; border-radius: 12px; box-shadow: 0 2px 4px rgba(0, 0, 0, 0.05);">
            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
              <h3 style="font-size: ${baseSize * 1.2}px; font-weight: 600; color: ${config.text_color || defaultConfig.text_color}; margin: 0;">Log Notifikasi Terbaru</h3>
              <div style="display: flex; gap: 8px;">
                <button id="filter-all-notif" class="notif-filter-btn" data-filter="all" style="padding: 6px 16px; background: ${config.primary_action_color || defaultConfig.primary_action_color}; color: white; border: none; border-radius: 6px; font-size: ${baseSize * 0.8}px; cursor: pointer; font-weight: 600;">Semua</button>
                <button id="filter-read-notif" class="notif-filter-btn" data-filter="read" style="padding: 6px 16px; background: transparent; color: ${config.text_color || defaultConfig.text_color}; border: 2px solid #e2e8f0; border-radius: 6px; font-size: ${baseSize * 0.8}px; cursor: pointer; font-weight: 600;">Dibaca</button>
                <button id="filter-unread-notif" class="notif-filter-btn" data-filter="unread" style="padding: 6px 16px; background: transparent; color: ${config.text_color || defaultConfig.text_color}; border: 2px solid #e2e8f0; border-radius: 6px; font-size: ${baseSize * 0.8}px; cursor: pointer; font-weight: 600;">Belum Dibaca</button>
              </div>
            </div>

            <div id="notifications-log" style="display: flex; flex-direction: column; gap: 12px; max-height: 600px; overflow-y: auto;">
              ${recentNotifications.length === 0 ? `
                <div style="text-align: center; padding: 40px 20px;">
                  <div style="font-size: ${baseSize * 3}px; margin-bottom: 16px;">üì≠</div>
                  <p style="font-size: ${baseSize}px; color: ${config.secondary_action_color || defaultConfig.secondary_action_color};">Belum ada notifikasi</p>
                </div>
              ` : recentNotifications.map(notif => `
                <div class="notification-item" data-read="${notif.read}" style="padding: 16px; background: ${config.background_color || defaultConfig.background_color}; border-radius: 8px; border-left: 4px solid ${notif.read ? '#10b981' : '#f59e0b'}; display: flex; justify-content: space-between; align-items: start; gap: 16px;">
                  <div style="flex: 1;">
                    <div style="display: flex; align-items: center; gap: 8px; margin-bottom: 6px;">
                      <span style="font-size: ${baseSize * 1.2}px;">${notif.read ? '‚úÖ' : 'üì®'}</span>
                      <span style="font-size: ${baseSize * 0.9}px; font-weight: 700; color: ${config.text_color || defaultConfig.text_color};">${notif.userName}</span>
                      <span style="padding: 2px 8px; background: ${notif.read ? '#d1fae5' : '#fef3c7'}; color: ${notif.read ? '#065f46' : '#92400e'}; border-radius: 10px; font-size: ${baseSize * 0.7}px; font-weight: 600;">${notif.read ? 'Dibaca' : 'Belum Dibaca'}</span>
                    </div>
                    <p style="font-size: ${baseSize * 0.85}px; color: ${config.text_color || defaultConfig.text_color}; margin: 8px 0; line-height: 1.5;">${notif.message}</p>
                    <p style="font-size: ${baseSize * 0.75}px; color: ${config.secondary_action_color || defaultConfig.secondary_action_color}; margin: 4px 0 0 0;">
                      üìÖ ${new Date(notif.sentAt).toLocaleString('id-ID', {
        day: '2-digit',
        month: 'short',
        year: 'numeric',
        hour: '2-digit',
        minute: '2-digit'
      })}
                    </p>
                  </div>
                  <div style="display: flex; align-items: center; gap: 8px;">
                    <span style="padding: 4px 10px; background: ${notif.status === 'delivered' ? '#d1fae5' : '#fee2e2'}; color: ${notif.status === 'delivered' ? '#065f46' : '#991b1b'}; border-radius: 8px; font-size: ${baseSize * 0.75}px; font-weight: 600; white-space: nowrap;">${notif.status === 'delivered' ? '‚úì Terkirim' : '‚úó Gagal'}</span>
                  </div>
                </div>
              `).join('')}
            </div>
          </div>
        </div>
      `;
    }

    // Helper functions
    function formatDate(dateStr) {
      const date = new Date(dateStr);
      return date.toLocaleDateString('id-ID', { day: '2-digit', month: 'long', year: 'numeric' });
    }

    function calculateDaysLeft(dateStr) {
      const today = new Date();
      today.setHours(0, 0, 0, 0);
      const deadline = new Date(dateStr);
      const diff = deadline - today;
      return Math.ceil(diff / (1000 * 60 * 60 * 24));
    }

    function getPriorityColor(priority) {
      const colors = {
        high: '#ef4444',
        medium: '#f59e0b',
        low: '#10b981'
      };
      return colors[priority] || colors.medium;
    }

    function getPriorityLabel(priority) {
      const labels = {
        high: 'Tinggi',
        medium: 'Sedang',
        low: 'Rendah'
      };
      return labels[priority] || labels.medium;
    }

    function calculateStats() {
      const userDeadlines = getCurrentUserDeadlines();
      return {
        total: userDeadlines.length,
        active: userDeadlines.filter(d => !d.completed).length,
        completed: userDeadlines.filter(d => d.completed).length
      };
    }

    function getFilteredDeadlines() {
      let filtered = getCurrentUserDeadlines();

      if (filterStatus !== 'all') {
        filtered = filtered.filter(d => {
          if (filterStatus === 'active') return !d.completed;
          if (filterStatus === 'completed') return d.completed;
          return true;
        });
      }

      if (filterPriority !== 'all') {
        filtered = filtered.filter(d => d.priority === filterPriority);
      }

      if (searchQuery) {
        filtered = filtered.filter(d =>
          d.title.toLowerCase().includes(searchQuery.toLowerCase()) ||
          d.description.toLowerCase().includes(searchQuery.toLowerCase())
        );
      }

      return filtered;
    }

    function showToast(message, type = 'success') {
      const toast = document.createElement('div');
      toast.className = 'toast';
      toast.style.background = type === 'success' ? '#10b981' : '#ef4444';
      toast.textContent = message;
      document.body.appendChild(toast);

      setTimeout(() => {
        toast.remove();
      }, 3000);
    }

    // Event listeners
    function attachEventListeners() {
      // Login
      const loginForm = document.getElementById('login-form');
      if (loginForm) {
        loginForm.addEventListener('submit', (e) => {
          e.preventDefault();
          const email = document.getElementById('login-email').value;
          const password = document.getElementById('login-password').value;

          const user = users.find(u => u.email === email && u.password === password);
          if (user) {
            currentUser = user;
            currentView = 'dashboard';
            showToast('Login berhasil!', 'success');
            renderApp();
          } else {
            showToast('Email atau password salah', 'error');
          }
        });
      }

      // Register
      const registerForm = document.getElementById('register-form');
      if (registerForm) {
        registerForm.addEventListener('submit', (e) => {
          e.preventDefault();
          const name = document.getElementById('register-name').value;
          const email = document.getElementById('register-email').value;
          const password = document.getElementById('register-password').value;

          if (users.find(u => u.email === email)) {
            showToast('Email sudah terdaftar', 'error');
            return;
          }

          const newUser = {
            id: Date.now().toString(),
            name,
            email,
            password,
            registered: new Date().toISOString().split('T')[0],
            status: 'active'
          };

          users.push(newUser);
          saveUsers();
          showToast('Registrasi berhasil! Silakan login.', 'success');
          currentView = 'login';
          renderApp();
        });
      }

      // Admin login
      const adminLoginForm = document.getElementById('admin-login-form');
      if (adminLoginForm) {
        adminLoginForm.addEventListener('submit', (e) => {
          e.preventDefault();
          const email = document.getElementById('admin-email').value;
          const password = document.getElementById('admin-password').value;

          if (email === 'admin@demo.com' && password === 'admin123') {
            currentUser = { id: 'admin', name: 'Administrator', email: email };
            isAdmin = true;
            currentView = 'admin';
            showToast('Login admin berhasil!', 'success');
            renderApp();
          } else {
            showToast('Email atau password admin salah', 'error');
          }
        });
      }

      // Admin sidebar toggle
      const adminMenuToggle = document.getElementById('admin-menu-toggle');
      const adminSidebar = document.getElementById('admin-sidebar');
      const adminSidebarOverlay = document.getElementById('admin-sidebar-overlay');
      const closeAdminSidebar = document.getElementById('close-admin-sidebar');

      if (adminMenuToggle && adminSidebar && adminSidebarOverlay) {
        adminMenuToggle.addEventListener('click', () => {
          adminSidebar.classList.add('open');
          adminSidebarOverlay.classList.add('show');
        });

        if (closeAdminSidebar) {
          closeAdminSidebar.addEventListener('click', () => {
            adminSidebar.classList.remove('open');
            adminSidebarOverlay.classList.remove('show');
          });
        }

        adminSidebarOverlay.addEventListener('click', () => {
          adminSidebar.classList.remove('open');
          adminSidebarOverlay.classList.remove('show');
        });
      }

      // Admin sidebar navigation
      const adminSidebarUsers = document.getElementById('admin-sidebar-users');
      const adminSidebarBroadcast = document.getElementById('admin-sidebar-broadcast');
      const adminSidebarReports = document.getElementById('admin-sidebar-reports');
      const adminSidebarMonitoring = document.getElementById('admin-sidebar-monitoring');
      const adminSidebarLogout = document.getElementById('admin-sidebar-logout');

      if (adminSidebarUsers) {
        adminSidebarUsers.addEventListener('click', () => {
          adminView = 'users';
          if (adminSidebar) adminSidebar.classList.remove('open');
          if (adminSidebarOverlay) adminSidebarOverlay.classList.remove('show');
          renderApp();
        });
      }

      if (adminSidebarBroadcast) {
        adminSidebarBroadcast.addEventListener('click', () => {
          adminView = 'broadcast';
          if (adminSidebar) adminSidebar.classList.remove('open');
          if (adminSidebarOverlay) adminSidebarOverlay.classList.remove('show');
          renderApp();
        });
      }

      if (adminSidebarReports) {
        adminSidebarReports.addEventListener('click', () => {
          adminView = 'reports';
          if (adminSidebar) adminSidebar.classList.remove('open');
          if (adminSidebarOverlay) adminSidebarOverlay.classList.remove('show');
          renderApp();
        });
      }

      if (adminSidebarMonitoring) {
        adminSidebarMonitoring.addEventListener('click', () => {
          adminView = 'monitoring';
          if (adminSidebar) adminSidebar.classList.remove('open');
          if (adminSidebarOverlay) adminSidebarOverlay.classList.remove('show');
          renderApp();
        });
      }

      if (adminSidebarLogout) {
        adminSidebarLogout.addEventListener('click', () => {
          currentUser = null;
          currentView = 'login';
          isAdmin = false;
          adminView = 'users';
          renderApp();
        });
      }

      // Navigation buttons
      const gotoRegister = document.getElementById('goto-register');
      if (gotoRegister) {
        gotoRegister.addEventListener('click', () => {
          currentView = 'register';
          renderApp();
        });
      }

      const gotoLogin = document.getElementById('goto-login');
      if (gotoLogin) {
        gotoLogin.addEventListener('click', () => {
          currentView = 'login';
          renderApp();
        });
      }

      const gotoAdminLogin = document.getElementById('goto-admin-login');
      if (gotoAdminLogin) {
        gotoAdminLogin.addEventListener('click', () => {
          currentView = 'admin-login';
          renderApp();
        });
      }

      const backToUserLogin = document.getElementById('back-to-user-login');
      if (backToUserLogin) {
        backToUserLogin.addEventListener('click', () => {
          currentView = 'login';
          renderApp();
        });
      }

      // Notification filter buttons
      const notifFilterBtns = document.querySelectorAll('.notif-filter-btn');
      notifFilterBtns.forEach(btn => {
        btn.addEventListener('click', (e) => {
          const filter = e.target.dataset.filter;
          const config = window.elementSdk?.config || defaultConfig;

          // Update button styles
          notifFilterBtns.forEach(b => {
            if (b === e.target) {
              b.style.background = config.primary_action_color || defaultConfig.primary_action_color;
              b.style.color = 'white';
              b.style.border = 'none';
            } else {
              b.style.background = 'transparent';
              b.style.color = config.text_color || defaultConfig.text_color;
              b.style.border = '2px solid #e2e8f0';
            }
          });

          // Filter notifications
          const notificationItems = document.querySelectorAll('.notification-item');
          notificationItems.forEach(item => {
            const isRead = item.dataset.read === 'true';
            if (filter === 'all') {
              item.style.display = 'flex';
            } else if (filter === 'read') {
              item.style.display = isRead ? 'flex' : 'none';
            } else if (filter === 'unread') {
              item.style.display = !isRead ? 'flex' : 'none';
            }
          });
        });
      });

      // Broadcast form
      const broadcastForm = document.getElementById('broadcast-form');
      const broadcastTarget = document.getElementById('broadcast-target');
      const customUserSelection = document.getElementById('custom-user-selection');

      if (broadcastTarget) {
        broadcastTarget.addEventListener('change', (e) => {
          if (customUserSelection) {
            customUserSelection.style.display = e.target.value === 'custom' ? 'block' : 'none';
          }
        });
      }

      // Select/deselect all users
      const selectAllUsers = document.getElementById('select-all-users');
      const deselectAllUsers = document.getElementById('deselect-all-users');

      if (selectAllUsers) {
        selectAllUsers.addEventListener('click', () => {
          const checkboxes = document.querySelectorAll('.user-checkbox');
          checkboxes.forEach(cb => cb.checked = true);
          updateSelectedCount();
        });
      }

      if (deselectAllUsers) {
        deselectAllUsers.addEventListener('click', () => {
          const checkboxes = document.querySelectorAll('.user-checkbox');
          checkboxes.forEach(cb => cb.checked = false);
          updateSelectedCount();
        });
      }

      // Update selected count
      const userCheckboxes = document.querySelectorAll('.user-checkbox');
      userCheckboxes.forEach(checkbox => {
        checkbox.addEventListener('change', updateSelectedCount);
      });

      function updateSelectedCount() {
        const selectedCount = document.querySelectorAll('.user-checkbox:checked').length;
        const countElement = document.getElementById('selected-count');
        if (countElement) {
          countElement.textContent = `${selectedCount} user dipilih`;
        }
      }

      if (broadcastForm) {
        broadcastForm.addEventListener('submit', (e) => {
          e.preventDefault();

          const target = document.getElementById('broadcast-target').value;
          const title = document.getElementById('broadcast-title').value;
          const message = document.getElementById('broadcast-message').value;

          let targetUsers = [];

          if (target === 'all') {
            targetUsers = users;
          } else if (target === 'active') {
            targetUsers = users.filter(u => u.status === 'active');
          } else if (target === 'inactive') {
            targetUsers = users.filter(u => u.status === 'inactive');
          } else if (target === 'custom') {
            const selectedIds = Array.from(document.querySelectorAll('.user-checkbox:checked')).map(cb => cb.value);
            if (selectedIds.length === 0) {
              showToast('Pilih minimal 1 user untuk broadcast', 'error');
              return;
            }
            targetUsers = users.filter(u => selectedIds.includes(u.id));
          }

          // Send notifications to all target users
          targetUsers.forEach(user => {
            const notification = {
              id: Date.now().toString() + Math.random(),
              userId: user.id,
              userName: user.name,
              message: `[${title}] ${message}`,
              sentAt: new Date().toISOString(),
              status: 'delivered',
              read: false
            };
            notificationLogs.push(notification);
          });

          // Save broadcast message
          const broadcast = {
            id: Date.now().toString(),
            title: title,
            message: message,
            recipientCount: targetUsers.length,
            sentAt: new Date().toISOString()
          };
          broadcastMessages.push(broadcast);

          saveNotifications();
          saveBroadcasts();

          showToast(`Broadcast berhasil dikirim ke ${targetUsers.length} user!`, 'success');

          // Reset form
          broadcastForm.reset();
          if (customUserSelection) {
            customUserSelection.style.display = 'none';
          }

          renderApp();
        });
      }
    }

    // Initialize Element SDK
    async function initElementSdk() {
      if (window.elementSdk) {
        await window.elementSdk.init({
          defaultConfig,
          onConfigChange: async (config) => {
            renderApp();
          },
          mapToCapabilities: (config) => ({
            recolorables: [
              { get: () => config.background_color || defaultConfig.background_color, set: (value) => { config.background_color = value; window.elementSdk.setConfig({ background_color: value }); } },
              { get: () => config.surface_color || defaultConfig.surface_color, set: (value) => { config.surface_color = value; window.elementSdk.setConfig({ surface_color: value }); } },
              { get: () => config.text_color || defaultConfig.text_color, set: (value) => { config.text_color = value; window.elementSdk.setConfig({ text_color: value }); } },
              { get: () => config.primary_action_color || defaultConfig.primary_action_color, set: (value) => { config.primary_action_color = value; window.elementSdk.setConfig({ primary_action_color: value }); } },
              { get: () => config.secondary_action_color || defaultConfig.secondary_action_color, set: (value) => { config.secondary_action_color = value; window.elementSdk.setConfig({ secondary_action_color: value }); } }
            ],
            borderables: [],
            fontEditable: { get: () => config.font_family || defaultConfig.font_family, set: (value) => { config.font_family = value; window.elementSdk.setConfig({ font_family: value }); } },
            fontSizeable: { get: () => config.font_size || defaultConfig.font_size, set: (value) => { config.font_size = value; window.elementSdk.setConfig({ font_size: value }); } }
          }),
          mapToEditPanelValues: (config) => new Map([
            ["app_title", config.app_title || defaultConfig.app_title],
            ["welcome_message", config.welcome_message || defaultConfig.welcome_message],
            ["button_text", config.button_text || defaultConfig.button_text]
          ])
        });
      }
    }

    // Start app
    (async () => {
      await initElementSdk();
      await initializeApp();
    })();
  </script>
  <script>(function () { function c() { var b = a.contentDocument || a.contentWindow.document; if (b) { var d = b.createElement('script'); d.innerHTML = "window.__CF$cv$params={r:'9ac1209ad02efd3a',t:'MTc2NTQxNTY4OS4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);"; b.getElementsByTagName('head')[0].appendChild(d) } } if (document.body) { var a = document.createElement('iframe'); a.height = 1; a.width = 1; a.style.position = 'absolute'; a.style.top = 0; a.style.left = 0; a.style.border = 'none'; a.style.visibility = 'hidden'; document.body.appendChild(a); if ('loading' !== document.readyState) c(); else if (window.addEventListener) document.addEventListener('DOMContentLoaded', c); else { var e = document.onreadystatechange || function () { }; document.onreadystatechange = function (b) { e(b); 'loading' !== document.readyState && (document.onreadystatechange = e, c()) } } } })();</script>
</body>

</html>